<?php

$instances = $this->instances;

if ($instances->hasData()) {
    $instanceInfo = $instances->getResources();
    $instanceData = $instances->getValues();
    
    $itemsOnPage = count($instanceData);
    
    $propertyInfo = $instances->getShownProperties();
    
    $start     = $instances->getOffset() + 1;
    $translate = OntoWiki::getInstance()->translate;
    
    $limit = $instances->getLimit();
    $offset = $instances->getOffset();
    if($limit != 0) {
        $page = ($offset / $limit) +1;
    } else {
        $page = 1;
    }
}

$odd = true;
if ($instances->hasData()):
?>
    <ul class="rounded">
        <?php foreach ($instanceInfo as $instanceUri => $instance): ?>
            <li>
                <!-- <?php echo $instance['url']?> -->
                <a about="<?php echo $instanceUri ?>" href="#">
                    <?php echo $instance['title'] ?>
                </a>
                <?php if (isset($instanceData[$instanceUri]) && isset($instanceData[$instanceUri]['__TYPE'])): ?>
                    <small class="counter">
                    <?php if (count($instanceData[$instanceUri]['__TYPE']) > 1): ?>
                        <?php $j = 0;
                        $count = count($instanceData[$instanceUri]['__TYPE']) ?>
                        <?php foreach ($instanceData[$instanceUri]['__TYPE'] as $type): ?>
                            <?php echo $type['value'] . ($count > ++$j ? ', ' : '') ?>
                        <?php endforeach; ?>
                    <?php else: ?>
                        <?php echo $instanceData[$instanceUri]['__TYPE'][0]['value'] ?>
                    <?php endif; ?>
                    </small>
                <?php endif; ?>
            </li>
        <?php endforeach; ?>
    </ul>
    <?php else: ?>
        <p class="messagebox info"><?php echo $this->_('No matches.') ?></p>
    <?php endif; ?>